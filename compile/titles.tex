%TC:ignore
% abbrevs spacing is fucked up
\makeatletter
\renewcommand\maybe@space@{%
  % \@tempswatrue % <= this is in the original
  \maybe@ictrue % <= this is new
  \expandafter   \@tfor
    \expandafter \reserved@a
    \expandafter :%
    \expandafter =%
                 \nospacelist
                 \do \t@st@ic
  % \if@tempswa % <= this is in the original
  \ifmaybe@ic % <= this is new
    \space
  \fi
}
\makeatother

\titleformat{\chapter}[display]
{\huge\singlespacing}
{\filleft\sc{\addfontfeature{LetterSpace=8.0}\chaptertitlename}\hspace{0pt} \fontsize{72pt}{72pt}\selectfont\color{white!70!black}\bfseries\thechapter}
{0.5ex}
{\uccoff
%\titlerule
\Large\addfontfeature{LetterSpace=-0.5}\filright}{\uccon}
% [
% \titlerule
% ]

\titlespacing*{\chapter}{0pt}{-40pt}{20pt}

\newcommand{\addperiod}[1]{#1.}
\setcounter{secnumdepth}{3}

\titleformat{\section}[hang]{\large\scshape\addfontfeature{LetterSpace=8.0}}{\thesection}{1em}{\uccoff}{\uccon}
\titleformat{\subsection}[hang]{\scshape\addfontfeature{LetterSpace=8.0}}{\thesubsection}{1em}{\uccoff}{\uccon}
\titleformat{\subsubsection}[runin]{\scshape\addfontfeature{LetterSpace=8.0}}{\thesubsubsection}{1em}{\uccoff\addperiod}{\uccon}
\titleformat{\paragraph}[runin]{\scshape\addfontfeature{LetterSpace=8.0}}{\theparagraph}{0em}{\uccoff}{\uccon}


\usepackage{chngcntr}
\counterwithout{equation}{chapter}
\counterwithout{footnote}{chapter}

\usepackage{caption}
\captionsetup{
    format = plain,
    labelsep=period,
    labelfont = sc
}

\usepackage{subcaption}
\captionsetup[sub]{
    labelformat = empty
}

\renewcommand{\cftchapfont}{\scshape}
\renewcommand{\cftchappresnum}{\large}
\renewcommand{\cftchapaftersnum}{\normalsize}
% \renewcommand{\cftsecfont}{\small}
\renewcommand{\cftsubsecfont}{\small}
\renewcommand{\cftsubsubsecfont}{\itshape\small}
\renewcommand{\cftchappagefont}{\footnotesize}
\renewcommand{\cftsecpagefont}{\footnotesize}
\renewcommand{\cftsubsecpagefont}{\footnotesize}
\renewcommand{\cftsubsubsecpagefont}{\footnotesize}
\renewcommand{\cftdot}{}
\renewcommand\cfttoctitlefont{\Large\sc\addfontfeature{LetterSpace=2.0}}
\renewcommand\cftloftitlefont{\Large\sc\addfontfeature{LetterSpace=2.0}}
\renewcommand\cftlottitlefont{\Large\sc\addfontfeature{LetterSpace=2.0}}
%TC:endignore
